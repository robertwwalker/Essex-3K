---
title: The Falklands
author: RWW
date: '2019-08-04'
slug: the-falklands
categories:
  - R
  - time series
tags: ["R"]
---

The data for the Falklands problem are shown below.

```{r DL, eval=FALSE, echo=TRUE}
library(haven)
br7983 <- read_dta("br7983.dta")
```

```{r RealDL, echo=FALSE, eval=TRUE}
br7983 <- structure(list(empx = structure(c(4.19999980926514, 4.19999980926514, 
4.19999980926514, 4.19999980926514, 4.19999980926514, 4.19999980926514, 
4.30000019073486, 4.40000009536743, 4.5, 4.69999980926514, 4.90000009536743, 
5.09999990463257, 5.30000019073486, 5.69999980926514, 6, 6.30000019073486, 
6.69999980926514, 7.09999990463257, 7.40000009536743, 7.59999990463257, 
7.90000009536743, 8.10000038146973, 8.30000019073486, 8.5, 8.69999980926514, 
8.80000019073486, 9, 9.10000038146973, 9.19999980926514, 9.30000019073486, 
9.39999961853027, 9.39999961853027, 9.5, 9.60000038146973, 9.60000038146973, 
9.80000019073486, 9.89999961853027, 10, 10.1000003814697, 10.1999998092651, 
10.3000001907349, 10.3999996185303, 10.5, 10, 10.5, 10.6000003814697, 
10.6999998092651, 10.8000001907349), format.stata = "%9.0g"), 
    empxl = structure(c(1.43508458137512, 1.43508458137512, 1.43508458137512, 
    1.43508458137512, 1.43508458137512, 1.43508458137512, 1.45861506462097, 
    1.48160457611084, 1.50407743453979, 1.54756247997284, 1.58923518657684, 
    1.6292405128479, 1.66770684719086, 1.74046611785889, 1.7917594909668, 
    1.84054958820343, 1.90210747718811, 1.96009480953217, 2.00148010253906, 
    2.02814817428589, 2.06686282157898, 2.09186410903931, 2.11625552177429, 
    2.14006614685059, 2.16332292556763, 2.17475175857544, 2.19722461700439, 
    2.20827436447144, 2.21920347213745, 2.23001432418823, 2.24070978164673, 
    2.24070978164673, 2.25129175186157, 2.26176309585571, 2.26176309585571, 
    2.28238248825073, 2.29253482818604, 2.30258512496948, 2.31253552436829, 
    2.3223876953125, 2.33214378356934, 2.34180569648743, 2.35137534141541, 
    2.30258512496948, 2.35137534141541, 2.36085391044617, 2.3702437877655, 
    2.37954616546631), format.stata = "%9.0g"), empxld = structure(c(NA, 
    0, 0, 0, 0, 0, 0.0235304981470108, 0.0229895189404488, 0.0224728565663099, 
    0.0434851124882698, 0.041672695428133, 0.0400053337216377, 
    0.0384662821888924, 0.0727593526244164, 0.0512932948768139, 
    0.0487901642918587, 0.0615578927099705, 0.0579872578382492, 
    0.0413852147758007, 0.0266682468354702, 0.0387145131826401, 
    0.0250013023614883, 0.0243914537131786, 0.0238106492906809, 
    0.0232568625360727, 0.011428696103394, 0.0224728565663099, 
    0.0110498359426856, 0.0109290704131126, 0.0108109163120389, 
    0.0106952888891101, 0, 0.0105821089819074, 0.0104713002219796, 
    0, 0.0206192880868912, 0.0101523716002703, 0.0100503358989954, 
    0.00995033048093319, 0.00985229667276144, 0.00975617486983538, 
    0.00966191105544567, 0.009569451212883, -0.0487901642918587, 
    0.0487901642918587, 0.00947874411940575, 0.00938974041491747, 
    0.00930239260196686), format.stata = "%9.0g"), govpop = structure(c(36, 
    36, 36, 35.5, 33.5, 33.5, 30.5, 31.5, 32, 32, 34, 36.5, 35, 
    32, 30.5, 34.5, 31.5, 29.5, 27.5, 28.5, 25, 25, 28, 25, 24, 
    23.5, 26.5, 25.5, 23, 18.5, 22.5, 22.5, 26, 25.5, 36.5, 39.5, 
    41, 38, 39, 36, 36, 33.5, 38, 39, 34.5, 35, 44, 42), format.stata = "%9.0g"), 
    month = structure(c(7907, 7908, 7909, 7910, 7911, 7912, 8001, 
    8002, 8003, 8004, 8005, 8006, 8007, 8008, 8009, 8010, 8011, 
    8012, 8101, 8102, 8103, 8104, 8105, 8106, 8107, 8108, 8109, 
    8110, 8111, 8112, 8201, 8202, 8203, 8204, 8205, 8206, 8207, 
    8208, 8209, 8210, 8211, 8212, 8301, 8302, 8303, 8304, 8305, 
    8306), format.stata = "%8.0g"), pexnew = structure(c(-3, 
    -4, 0, 0, -16, -16, -22, -18, -18, -7, -4, -8, -10, -9, -14, 
    -12, -13, -14, -15, -11, -18, -16, -11, -16, -14, -12, -9, 
    -16, -13, -20, -14, -16, -10, -8, -2, -3, -3, -2, 1, -5, 
    -2, -2, -10, -4, 1, 2, 13, 9), format.stata = "%8.0g"), pexnewl = structure(c(2.99573230743408, 
    2.94443893432617, 3.13549423217773, 3.13549423217773, 1.94591009616852, 
    1.94591009616852, 0, 1.60943794250488, 1.60943794250488, 
    2.7725887298584, 2.94443893432617, 2.70805025100708, 2.56494927406311, 
    2.63905739784241, 2.19722461700439, 2.39789533615112, 2.30258512496948, 
    2.19722461700439, 2.0794415473938, 2.4849066734314, 1.60943794250488, 
    1.94591009616852, 2.4849066734314, 1.94591009616852, 2.19722461700439, 
    2.39789533615112, 2.63905739784241, 1.94591009616852, 2.30258512496948, 
    1.0986123085022, 2.19722461700439, 1.94591009616852, 2.56494927406311, 
    2.70805025100708, 3.04452252388, 2.99573230743408, 2.99573230743408, 
    3.04452252388, 3.178053855896, 2.89037179946899, 3.04452252388, 
    3.04452252388, 2.56494927406311, 2.94443893432617, 3.178053855896, 
    3.21887588500977, 3.58351898193359, 3.465735912323), format.stata = "%9.0g"), 
    retailpj = structure(c(15.8000001907349, 15.8000001907349, 
    16.5, 17.1000003814697, 17.2000007629395, 17.2999992370605, 
    18.7999992370605, 19.5, 20.2000007629395, 22.3999996185303, 
    22.6000003814697, 21.7000007629395, 17, 16.5, 16.1000003814697, 
    15.6999998092651, 15.6999998092651, 15.3999996185303, 13.3999996185303, 
    12.8000001907349, 12.8999996185303, 12.3000001907349, 11.6999998092651, 
    11.3000001907349, 11, 11.6000003814697, 11.3999996185303, 
    11.5, 11.8000001907349, 11.8000001907349, 11.5, 10.6000003814697, 
    9.89999961853027, 8.89999961853027, 8.89999961853027, 8.80000019073486, 
    8.60000038146973, 8, 7.5, 7.19999980926514, 6.59999990463257, 
    5.80000019073486, 5.5, 5.80000019073486, 5.19999980926514, 
    4.59999990463257, 4.40000009536743, 4.09999990463257), format.stata = "%9.0g"), 
    thatsat = structure(c(41, 45, 45, 46, 44, 40, 39, 37, 38, 
    41, 44, 43, 41, 41, 37, 38, 34, 35, 32, 34, 30, 30, 35, 33, 
    30, 28, 32, 33, 28, 25, 32, 29, 34, 35, 44, 51, 52, 49, 48, 
    46, 44, 44, 49, 45, 47, 44, 50, 48), format.stata = "%8.0g"), 
    gexnew = structure(c(-33, -26, -32, -20, -35, -35, -48, -46, 
    -37, -29, -17, -18, -22, -14, -20, -11, -21, -22, -23, -15, 
    -24, -7, -10, -27, -25, -15, -3, -27, -16, -20, -6, -24, 
    -12, 2, 9, 15, 2, -3, 9, 5, 3, -11, -11, -13, 5, 7, 27, 11
    ), format.stata = "%8.0g"), trx = structure(c(0, 1, 2, 3, 
    4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 
    20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 
    35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47), format.stata = "%8.0g"), 
    fland = structure(c(0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
    0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1), format.stata = "%8.0g"), 
    flandt = structure(c(0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
    0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0), format.stata = "%8.0g"), 
    trz = structure(c(1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 
    13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 
    28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 
    43, 44, 45, 46, 47, 48), format.stata = "%9.0g"), retpjl = structure(c(2.76001000404358, 
    2.76001000404358, 2.80336046218872, 2.83907842636108, 2.84490942955017, 
    2.85070633888245, 2.93385672569275, 2.97041440010071, 3.00568270683289, 
    3.10906100273132, 3.11794996261597, 3.07731223106384, 2.83321332931519, 
    2.80336046218872, 2.77881932258606, 2.75366067886353, 2.75366067886353, 
    2.73436737060547, 2.59525465965271, 2.54944515228271, 2.55722737312317, 
    2.50959920883179, 2.45958876609802, 2.42480278015137, 2.39789533615112, 
    2.45100522041321, 2.43361330032349, 2.44234704971313, 2.46809959411621, 
    2.46809959411621, 2.44234704971313, 2.36085414886475, 2.29253482818604, 
    2.1860511302948, 2.1860511302948, 2.17475175857544, 2.15176224708557, 
    2.0794415473938, 2.01490306854248, 1.97408103942871, 1.88706958293915, 
    1.75785791873932, 1.70474803447723, 1.75785791873932, 1.64865863323212, 
    1.52605628967285, 1.48160457611084, 1.41098690032959), format.stata = "%9.0g"), 
    govpopl = structure(c(3.58351898193359, 3.58351898193359, 
    3.58351898193359, 3.56953263282776, 3.51154541969299, 3.51154541969299, 
    3.41772675514221, 3.4499876499176, 3.465735912323, 3.465735912323, 
    3.52636051177979, 3.59731221199036, 3.55534815788269, 3.465735912323, 
    3.41772675514221, 3.54095935821533, 3.4499876499176, 3.38439035415649, 
    3.31418609619141, 3.34990406036377, 3.21887588500977, 3.21887588500977, 
    3.33220458030701, 3.21887588500977, 3.178053855896, 3.15700030326843, 
    3.27714467048645, 3.23867845535278, 3.13549423217773, 2.91777062416077, 
    3.11351537704468, 3.11351537704468, 3.25809645652771, 3.23867845535278, 
    3.59731221199036, 3.67630076408386, 3.71357202529907, 3.63758611679077, 
    3.66356158256531, 3.58351898193359, 3.58351898193359, 3.51154541969299, 
    3.63758611679077, 3.66356158256531, 3.54095935821533, 3.55534815788269, 
    3.78418970108032, 3.7376697063446), format.stata = "%9.0g"), 
    govpopld = structure(c(NA, 0, 0, -0.013986349105835, -0.0579872131347656, 
    0, -0.0938186645507812, 0.0322608947753906, 0.0157482624053955, 
    0, 0.0606245994567871, 0.0709517002105713, -0.041964054107666, 
    -0.0896122455596924, -0.0480091571807861, 0.12323260307312, 
    -0.0909717082977295, -0.0655972957611084, -0.0702042579650879, 
    0.0357179641723633, -0.131028175354004, 0, 0.113328695297241, 
    -0.113328695297241, -0.0408220291137695, -0.0210535526275635, 
    0.120144367218018, -0.038466215133667, -0.103184223175049, 
    -0.217723608016968, 0.195744752883911, 0, 0.144581079483032, 
    -0.0194180011749268, 0.358633756637573, 0.0789885520935059, 
    0.03727126121521, -0.0759859085083008, 0.0259754657745361, 
    -0.0800426006317139, 0, -0.0719735622406006, 0.126040697097778, 
    0.0259754657745361, -0.122602224349976, 0.0143887996673584, 
    0.228841543197632, -0.0465199947357178), format.stata = "%9.0g"), 
    retpjld = structure(c(NA, 0, 0.0433504581451416, 0.0357179641723633, 
    0.00583100318908691, 0.00579690933227539, 0.0831503868103027, 
    0.036557674407959, 0.0352683067321777, 0.103378295898438, 
    0.00888895988464355, -0.040637731552124, -0.244098901748657, 
    -0.0298528671264648, -0.0245411396026611, -0.0251586437225342, 
    0, -0.0192933082580566, -0.139112710952759, -0.0458095073699951, 
    0.0077822208404541, -0.0476281642913818, -0.0500104427337646, 
    -0.0347859859466553, -0.0269074440002441, 0.053109884262085, 
    -0.0173919200897217, 0.00873374938964844, 0.0257525444030762, 
    0, -0.0257525444030762, -0.0814929008483887, -0.0683193206787109, 
    -0.106483697891235, 0, -0.0112993717193604, -0.0229895114898682, 
    -0.0723206996917725, -0.0645384788513184, -0.0408220291137695, 
    -0.087011456489563, -0.129211664199829, -0.053109884262085, 
    0.053109884262085, -0.109199285507202, -0.122602343559265, 
    -0.0444517135620117, -0.07061767578125), format.stata = "%9.0g"), 
    flandd = structure(c(0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
    0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0), format.stata = "%9.0g"), 
    flanddlag1 = structure(c(NA, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
    0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
    0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0), format.stata = "%9.0g")), row.names = c(NA, 
-48L), class = c("tbl_df", "tbl", "data.frame"))
```

A brief glimpse.

```{r}
head(br7983)
```

It is important to note the sequence here.  In the original data, Falklands measures from April.  We may wish May.  To do that

```{r}
br7983$flandl <- 0
br7983$flandl[br7983$month > 8204] <- 1
```

The outcome of interest is `govpop`.  What does it look like?

```{r}
plot(br7983$govpop,x=as.factor(br7983$month), xlab="Time", ylab="Government Popularity", type="l")
```


Some example models, use `TSA`

```{r}
library(TSA)
summary(lm(govpop~pexnew+empx+fland, data=br7983))
model <- arimax(br7983$govpop, order=c(1,0,0), xtransf=br7983$fland, transfer=list(c(1,0)))
model
model <- arimax(br7983$govpop, order=c(1,0,0), xtransf=br7983$flandl, transfer=list(c(1,0)))
model
```

